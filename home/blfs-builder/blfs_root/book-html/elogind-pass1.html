<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /><title>elogind-246.10</title><link rel="stylesheet" type="text/css" href="stylesheets/lfs.css" /><meta name="generator" content="DocBook XSL-NS Stylesheets Vsnapshot" /><link rel="stylesheet" href="stylesheets/lfs-print.css" type="text/css" media="print" /></head><body class="blfs" id="blfs-11.0"><div class="navheader"><h4>Beyond Linux<sup>®</sup> From Scratch 
  
  <span class="phrase">(System V</span> Edition) - Version 11.0</h4><h3>Chapter 1. Installing packages in dependency build order</h3><ul><li class="prev"><a accesskey="p" href="libpwquality.html" title="libpwquality-1.4.4">Prev</a><p>libpwquality-1.4.4</p></li><li class="next"><a accesskey="n" href="polkit.html" title="Polkit-0.119">Next</a><p>Polkit-0.119</p></li><li class="up"><a accesskey="u" href="ch01.html" title="Chapter 1. Installing packages in dependency build order">Up</a></li><li class="home"><a accesskey="h" href="index.html" title="Beyond Linux® From Scratch &#10;  &#10;  (System V Edition) - Version 11.0">Home</a></li></ul></div><div class="sect1" lang="en" xml:lang="en"><h1 class="sect1"><a id="elogind-pass1" name="elogind-pass1"></a>elogind-246.10</h1><div class="package" lang="en" xml:lang="en"><h2 class="sect2">Introduction to elogind</h2><p>
      <span class="application">elogind</span> is the
      <span class="application">systemd</span> project's "logind", extracted out to
      be a standalone daemon.  It integrates with <a class="xref" href="linux-pam.html" title="Linux-PAM-1.5.1">Linux-PAM-1.5.1</a>
      to know the set of users that are logged in to a system and whether they
      are logged in graphically, on the console, or remotely.
      <span class="application">Elogind</span> exposes this information via the
      standard org.freedesktop.login1 <span class="application">D-Bus</span>
      interface, as well as through the file system using systemd's standard
      <code class="filename">/run/systemd</code> layout.
    </p><p>This package is known to build and work
                              properly using an LFS-11.0 platform.</p><h3>Package Information</h3><div class="itemizedlist"><ul class="compact"><li class="listitem"><p>
          Download (HTTP): <a class="ulink" href="https://github.com/elogind/elogind/archive/v246.10/elogind-246.10.tar.gz">https://github.com/elogind/elogind/archive/v246.10/elogind-246.10.tar.gz</a>
        </p></li><li class="listitem"></li><li class="listitem"><p>
          Download MD5 sum: 32ab2201281f14738d9c045f3669c14d
        </p></li><li class="listitem"><p>
          Download size: 1.5 MB
        </p></li><li class="listitem"><p>
          Estimated disk space required: 41 MB (with tests)
        </p></li><li class="listitem"><p>
          Estimated build time: 0.2 SBU (with parallelism=4)
        </p></li></ul></div><h3>elogind Dependencies</h3><h4>Required</h4><p class="required">
      dbus (in full book)
              
    </p><h4>Recommended</h4><p class="recommended">
      <a class="xref" href="linux-pam.html" title="Linux-PAM-1.5.1">Linux-PAM-1.5.1</a> (required for Xorg),
      <a class="xref" href="polkit.html" title="Polkit-0.119">Polkit-0.119</a> (runtime), 
      DocBook (in full book)
              ,
      docbook-xsl (in full book)
              , and
      libxslt (in full book)
               (all three to build the man pages) 
    </p><h4>Optional</h4><p class="optional">
      For the tests:
      lxml (in full book)
              ,
      gobject-introspection (in full book)
              ,
      zsh (in full book)
              ,
      valgrind (in full book)
              ,
      <a class="ulink" href="https://github.com/linux-audit/audit-userspace">
      audit-userspace</a>,
      <a class="ulink" href="https://github.com/scop/bash-completion">
      bash-completion</a>,
      <a class="ulink" href="https://mirrors.edge.kernel.org/pub/linux/utils/kernel/kexec/">
      kexec</a>, and
      <a class="ulink" href="http://www.selinuxproject.org/page/Main_Page">
      SELinux</a>
    </p><p class="usernotes">User Notes:
      <a class="ulink" href="https://wiki.linuxfromscratch.org/blfs/wiki/elogind">https://wiki.linuxfromscratch.org/blfs/wiki/elogind</a>
    </p></div><div class="kernel" lang="en" xml:lang="en"><h2 class="sect2"><a id="elogind-kernel-pass1" name="elogind-kernel-pass1"></a>Kernel Configuration</h2><p>
      Enable the following options in the kernel configuration and recompile the
      kernel if necessary:
    </p><pre class="screen"><code class="literal">General setup ---&gt;
    [*]     Control Group support                        [CONFIG_CGROUPS]
File systems ---&gt;
    [*]     Inotify support for userspace                [CONFIG_INOTIFY_USER]
            Pseudo filesystems ---&gt;
                [*]    Tmpfs POSIX Access Control Lists  [CONFIG_TMPFS_POSIX_ACL]</code></pre><p>
      In addition, some tests need the userspace cryptographic kernel API, which
      is enabled with:
    </p><pre class="screen"><code class="literal">-*- Cryptographic API ---&gt;                               [CONFIG_CRYPTO]
   &lt;M/*&gt; Userspace cryptographic algorithm configuration [CONFIG_CRYPTO_USER]
   &lt;M/*&gt; User-space interface for hash algorithms        [CONFIG_CRYPTO_USER_API_HASH]</code></pre></div><div class="installation" lang="en" xml:lang="en"><h2 class="sect2">Installation of elogind</h2><p>
      Install <span class="application">elogind</span> by running the following
      commands:
    </p><pre class="userinput"><kbd class="command">sed -i '/Disable polkit/,+8 d' meson.build &amp;&amp;

mkdir build &amp;&amp;
cd    build &amp;&amp;

meson --prefix=/usr                        \
      --buildtype=release                  \
      -Dcgroup-controller=elogind          \
      -Ddbuspolicydir=/etc/dbus-1/system.d \
      -Dman=auto                           \
      ..  &amp;&amp;
ninja</kbd></pre><p>
      To test the results, issue: <span class="command"><strong>ninja test</strong></span>. A few tests
      are skipped if not run with <code class="systemitem">root</code>
      privileges.
    </p><p>
      Now, as the <code class="systemitem">root</code> user:
    </p><pre class="root"><kbd class="command">ninja install                                           &amp;&amp;
ln -sfv  libelogind.pc /usr/lib/pkgconfig/libsystemd.pc &amp;&amp;
ln -sfvn elogind /usr/include/systemd</kbd></pre></div><div class="commands" lang="en" xml:lang="en"><h2 class="sect2">Command Explanations</h2><p>
      <span class="command"><strong>sed ... meson.build</strong></span>: This change allows the
      package to be built without polkit being installed (it is still a
      runtime dependency) but able to use polkit after that package is 
      installed.
    </p><p>
      <em class="parameter"><code>-Dcgroup-controller=elogind</code></em>: This switch ensures
      that <span class="application">elogind</span> is selected as the cgroup
      controller, even if booted with another running cgroup controller.
    </p><p>
      <em class="parameter"><code>-Ddbuspolicydir=/etc/dbus-1/system.d</code></em>: This switch
      sets the location of the <span class="application">D-Bus</span> policy
      directory.
    </p><p>
      <em class="parameter"><code>-Dman=auto</code></em>: The default value of this switch is
      <span class="emphasis"><em>false</em></span>. Setting it to <span class="emphasis"><em>auto</em></span>
      allows building and installing the man pages if the recommended
      dependencies are installed.
    </p><p>
      <code class="option">-Ddefault-kill-user-processes=false</code>: Configure whether
      the processes of a user should be killed when the user logs out. The
      default is <span class="emphasis"><em>true</em></span>, but this defeats the traditional
      use of <span class="command"><strong>screen</strong></span> or <span class="command"><strong>tmux</strong></span>. This can
      also be changed in the configuration file (see below).
    </p><p>
      <span class="command"><strong>ln -s ...</strong></span>: These commands install symlinks so that
      software packages find systemd compatible library and headers.
    </p></div><div class="configuration" lang="en" xml:lang="en"><h2 class="sect2">Configuring elogind</h2><div class="sect3" lang="en" xml:lang="en"><h3 class="sect3"><a id="elogind-config-pass1" name="elogind-config-pass1"></a><h4 class="title"><a id="elogind-config-pass1"></a>Config File</h4></h3><p>
        <code class="filename">/etc/elogind/logind.conf</code>
      </p></div><div class="sect3" lang="en" xml:lang="en"><h3 class="sect3"><h4 class="title"><a id="idm140019318479376"></a>Configuration Information</h4></h3><p>
        The installed file <code class="filename">/etc/elogind/logind.conf</code>
        contains all the possible options with their defaults, commented
        out. You may wish to disable killing user processes when the user logs
        out, by running, as the <code class="systemitem">root</code>
        user:
      </p><pre class="root"><kbd class="command">sed -e '/\[Login\]/a KillUserProcesses=no' \
    -i /etc/elogind/logind.conf</kbd></pre><p>
        Each user will need to register a user session using
        <span class="application">Linux-PAM</span> at login. The
        <code class="filename">/etc/pam.d/system-session</code> file needs to
        be modified and a new file needs to be created in order for
        <span class="command"><strong>elogind</strong></span> to work correctly. Run the following
        commands as the <code class="systemitem">root</code> user:
      </p><pre class="root"><kbd class="command">cat &gt;&gt; /etc/pam.d/system-session &lt;&lt; "EOF" &amp;&amp;
<code class="literal"># Begin elogind addition
    
session  required    pam_loginuid.so
session  optional    pam_elogind.so

# End elogind addition</code>
EOF
cat &gt; /etc/pam.d/elogind-user &lt;&lt; "EOF"
<code class="literal"># Begin /etc/pam.d/elogind-user

account  required    pam_access.so
account  include     system-account

session  required    pam_env.so
session  required    pam_limits.so
session  required    pam_unix.so
session  required    pam_loginuid.so
session  optional    pam_keyinit.so force revoke
session  optional    pam_elogind.so

auth     required    pam_deny.so
password required    pam_deny.so

# End /etc/pam.d/elogind-user</code>
EOF</kbd></pre></div></div><div class="content" lang="en" xml:lang="en"><h2 class="sect2">Contents</h2><div class="segmentedlist"><div class="seglistitem"><div class="seg"><strong class="segtitle">Installed Programs: </strong><span class="segbody">
          busctl,
          elogind-inhibit, and
          loginctl
        </span></div><div class="seg"><strong class="segtitle">Installed Library: </strong><span class="segbody">
           libelogind.so
        </span></div><div class="seg"><strong class="segtitle">Installed Directories: </strong><span class="segbody">
          /lib/elogind,
          /etc/elogind,
          /usr/include/elogind, and
          /usr/share/doc/elogind-246.10
        </span></div></div></div><div class="variablelist"><h3>Short Descriptions</h3><dl class="variablelist"><dt><a id="busctl-pass1"></a><span class="term"><span class="command"><strong>busctl</strong></span></span></dt><dd><p>
            is used to introspect and monitor the D-Bus bus
          </p></dd><dt><a id="elogind-inhibit-pass1"></a><span class="term"><span class="command"><strong>elogind-inhibit</strong></span></span></dt><dd><p>
            is used to execute a program with a shutdown, sleep or idle
            inhibitor lock taken
          </p></dd><dt><a id="loginctl-pass1"></a><span class="term"><span class="command"><strong>loginctl</strong></span></span></dt><dd><p>
            is used to introspect and control the state of the elogind Login
            Manager
          </p></dd><dt><a id="libelogind-pass1"></a><span class="term"><code class="filename">libelogind.so</code></span></dt><dd><p>
            is the main elogind utility library
          </p></dd></dl></div></div><p class="updated">Last updated 
      on
      </p></div><div class="navfooter"><ul><li class="prev"><a accesskey="p" href="libpwquality.html" title="libpwquality-1.4.4">Prev</a><p>libpwquality-1.4.4</p></li><li class="next"><a accesskey="n" href="polkit.html" title="Polkit-0.119">Next</a><p>Polkit-0.119</p></li><li class="up"><a accesskey="u" href="ch01.html" title="Chapter 1. Installing packages in dependency build order">Up</a></li><li class="home"><a accesskey="h" href="index.html" title="Beyond Linux® From Scratch &#10;  &#10;  (System V Edition) - Version 11.0">Home</a></li></ul></div></body></html>