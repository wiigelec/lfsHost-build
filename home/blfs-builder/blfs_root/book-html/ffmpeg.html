<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /><title>FFmpeg-4.4</title><link rel="stylesheet" type="text/css" href="stylesheets/lfs.css" /><meta name="generator" content="DocBook XSL-NS Stylesheets Vsnapshot" /><link rel="stylesheet" href="stylesheets/lfs-print.css" type="text/css" media="print" /></head><body class="blfs" id="blfs-11.0"><div class="navheader"><h4>Beyond Linux<sup>®</sup> From Scratch 
  
  <span class="phrase">(System V</span> Edition) - Version 11.0</h4><h3>Chapter 1. Installing packages in dependency build order</h3><ul><li class="prev"><a accesskey="p" href="sdl2.html" title="SDL2-2.0.16">Prev</a><p>SDL2-2.0.16</p></li><li class="next"><a accesskey="n" href="appendices/creat-comm.html" title="Creative Commons License">Next</a><p>Creative Commons License</p></li><li class="up"><a accesskey="u" href="ch01.html" title="Chapter 1. Installing packages in dependency build order">Up</a></li><li class="home"><a accesskey="h" href="index.html" title="Beyond Linux® From Scratch &#10;  &#10;  (System V Edition) - Version 11.0">Home</a></li></ul></div><div class="sect1" lang="en" xml:lang="en"><h1 class="sect1"><a id="ffmpeg" name="ffmpeg"></a>FFmpeg-4.4</h1><div class="package" lang="en" xml:lang="en"><h2 class="sect2">Introduction to FFmpeg</h2><p>
      <span class="application">FFmpeg</span> is a solution to record, convert and
      stream audio and video. It is a very fast video and audio converter and it
      can also acquire from a live audio/video source. Designed to be intuitive,
      the command-line interface (<span class="command"><strong>ffmpeg</strong></span>) tries to figure out
      all the parameters, when possible. <span class="application">FFmpeg</span> can
      also convert from any sample rate to any other, and resize video on the
      fly with a high quality polyphase filter.
      <span class="application">FFmpeg</span> can use a Video4Linux compatible video
      source and any Open Sound System audio source.
    </p><p>This package is known to build and work
                              properly using an LFS-11.0 platform.</p><h3>Package Information</h3><div class="itemizedlist"><ul class="compact"><li class="listitem"><p>
          Download (HTTP): <a class="ulink" href="https://ffmpeg.org/releases/ffmpeg-4.4.tar.xz">https://ffmpeg.org/releases/ffmpeg-4.4.tar.xz</a>
        </p></li><li class="listitem"></li><li class="listitem"><p>
          Download MD5 sum: 7b9d5b652d20e8c5405304ad72636d4a
        </p></li><li class="listitem"><p>
          Download size: 9.2 MB
        </p></li><li class="listitem"><p>
          Estimated disk space required: 176 MB (add 2.4 GB for the FATE suite/tests, add 1.4 GB for documentation)
        </p></li><li class="listitem"><p>
          Estimated build time: 1.3 SBU (using parallelism=4; add 3.6 SBU (with THREADS=4) to run the FATE suite after sample files are downloaded; add 0.7 SBU for doxygen docs)
        </p></li></ul></div><h3>FFmpeg Dependencies</h3><h4>Recommended</h4><p class="recommended">
      <a class="xref" href="libass.html" title="libass-0.15.1">libass-0.15.1</a>,
      <a class="xref" href="fdk-aac.html" title="fdk-aac-2.0.2">fdk-aac-2.0.2</a>,
      freetype2 (in full book)
              ,
      <a class="xref" href="lame.html" title="LAME-3.100">LAME-3.100</a>,
      <a class="xref" href="libtheora.html" title="libtheora-1.1.1">libtheora-1.1.1</a>,
      <a class="xref" href="libvorbis.html" title="libvorbis-1.3.7">libvorbis-1.3.7</a>,
      <a class="xref" href="libvpx.html" title="libvpx-1.10.0">libvpx-1.10.0</a>,
      <a class="xref" href="opus.html" title="Opus-1.3.1">Opus-1.3.1</a>,
      <a class="xref" href="x264.html" title="x264-20210814">x264-20210814</a>,
      <a class="xref" href="x265.html" title="x265-3.4">x265-3.4</a>, and
      <a class="xref" href="nasm.html" title="NASM-2.15.05">NASM-2.15.05</a> or <a class="xref" href="yasm.html" title="yasm-1.3.0">yasm-1.3.0</a>
    </p><h4>Recommended for desktop use</h4><p class="recommended">
      <a class="xref" href="alsa-lib.html" title="alsa-lib-1.2.5.1">alsa-lib-1.2.5.1</a>,
      libva (in full book)
              ,
      libvdpau (in full book)
               (with the corresponding driver package), and
      <a class="xref" href="sdl2.html" title="SDL2-2.0.16">SDL2-2.0.16</a>
    </p><h4>Optional</h4><p class="optional">
      doxygen (in full book)
              ,
      fontconfig (in full book)
              ,
      <a class="xref" href="fribidi.html" title="FriBidi-1.0.9">FriBidi-1.0.9</a>,
      frei0r (in full book)
              ,
      libcdio (in full book)
               (to identify and play CDs),
      libdrm (in full book)
               (for <span class="quote">&#8220;<span class="quote">kmsgrab</span>&#8221;</span> input),
      libwebp (in full book)
              ,
      opencv (in full book)
              ,
      openjpeg2 (in full book)
              ,
      gnutls (in full book)
              ,
      pulseaudio (in full book)
              ,
      samba (in full book)
              ,
      speex (in full book)
              ,
      texlive (in full book)
              
         (or tl-installer (in full book)
              ) for PDF and PS documentation,
      v4l-utils (in full book)
              ,
      xvid (in full book)
              ,
      x-window-system (in full book)
              ,
      <a class="ulink" href="http://www.speech.cs.cmu.edu/flite/">Flite</a>,
      <a class="ulink" href="http://www.quut.com/gsm/">GSM</a>,
      
      
      <a class="ulink" href="http://tipok.org.ua/node/17">libaacplus</a>,
      <a class="ulink" href="http://www.videolan.org/developers/libbluray.html">libbluray</a>,
      <a class="ulink" href="http://caca.zoy.org/">libcaca</a>,
      <a class="ulink" href="https://gitlab.xiph.org/xiph/celt">libcelt</a>,
      <a class="ulink" href="https://sourceforge.net/projects/libdc1394">libdc1394</a>,
      <a class="ulink" href="https://www.videolan.org/developers/libdca.html">libdca</a>,
      <a class="ulink" href="https://ieee1394.wiki.kernel.org/index.php/Libraries">libiec61883</a>,
      <a class="ulink" href="https://github.com/dekkers/libilbc">libilbc</a>,
      <a class="ulink" href="https://sourceforge.net/projects/modplug-xmms/">libmodplug</a>,
      <a class="ulink" href="https://github.com/Distrotech/libnut">libnut</a> (Git checkout),
      <a class="ulink" href="http://rtmpdump.mplayerhq.hu/">librtmp</a>,
      <a class="ulink" href="http://www.libssh.org/">libssh</a>,
      
      <a class="ulink" href="https://openal.org/">OpenAL</a>,
      <a class="ulink" href="https://sourceforge.net/projects/opencore-amr">OpenCore AMR</a>,
      
      <a class="ulink" href="https://sourceforge.net/projects/schrodinger/">Schroedinger</a>,
      <a class="ulink" href="http://www.twolame.org/">TwoLAME</a>,
      <a class="ulink" href="https://sourceforge.net/projects/opencore-amr/files/vo-aacenc/">vo-aaenc</a>,
      <a class="ulink" href="https://sourceforge.net/projects/opencore-amr/files/vo-amrwbenc/">vo-amrwbenc</a>, and
      
      <a class="ulink" href="http://zapping.sourceforge.net/ZVBI/">ZVBI</a>
    </p><p class="usernotes">
      User Notes: <a class="ulink" href="https://wiki.linuxfromscratch.org/blfs/wiki/ffmpeg">https://wiki.linuxfromscratch.org/blfs/wiki/ffmpeg</a>
    </p></div><div class="installation" lang="en" xml:lang="en"><h2 class="sect2">Installation of FFmpeg</h2><p>
      Install <span class="application">FFmpeg</span> by running the following
      commands:
    </p><pre class="userinput"><kbd class="command">sed -i 's/-lflite"/-lflite -lasound"/' configure &amp;&amp;

./configure --prefix=/usr        \
            --enable-gpl         \
            --enable-version3    \
            --enable-nonfree     \
            --disable-static     \
            --enable-shared      \
            --disable-debug      \
            --enable-avresample  \
            --enable-libass      \
            --enable-libfdk-aac  \
            --enable-libfreetype \
            --enable-libmp3lame  \
            --enable-libopus     \
            --enable-libtheora   \
            --enable-libvorbis   \
            --enable-libvpx      \
            --enable-libx264     \
            --enable-libx265     \
            --enable-openssl     \
            --docdir=/usr/share/doc/ffmpeg-4.4 &amp;&amp;

make &amp;&amp;

gcc tools/qt-faststart.c -o tools/qt-faststart</kbd></pre><p>
      HTML documentation was built in the previous step. If  you have
      texlive (in full book)
               installed and wish to build PDF and
      Postscript versions of the documentation, issue the following commands:
    </p><pre class="userinput"><kbd class="command">pushd doc &amp;&amp;
for DOCNAME in `basename -s .html *.html`
do
    texi2pdf -b $DOCNAME.texi &amp;&amp;
    texi2dvi -b $DOCNAME.texi &amp;&amp;

    dvips    -o $DOCNAME.ps   \
                $DOCNAME.dvi
done &amp;&amp;
popd &amp;&amp;
unset DOCNAME</kbd></pre><p>
      If you have doxygen (in full book)
               installed 
      and you wish to build (if --disable-doc was
      used) or rebuild the html documentation, issue:
    </p><pre class="userinput"><kbd class="command">doxygen doc/Doxyfile</kbd></pre><p>
      The fate-suite tests include comparisons with installed files, and should
      not be run before the package is installed. Therefore, if you desire to
      run them, instructions are given further below.
    </p><p>
      Now, as the <code class="systemitem">root</code> user:
    </p><pre class="root"><kbd class="command">make install &amp;&amp;

install -v -m755    tools/qt-faststart /usr/bin &amp;&amp;
install -v -m755 -d           /usr/share/doc/ffmpeg-4.4 &amp;&amp;
install -v -m644    doc/*.txt /usr/share/doc/ffmpeg-4.4</kbd></pre><p>
      If the PDF and Postscript documentation was built, issue the following
      commands, as the <code class="systemitem">root</code> user, to
      install them:
    </p><pre class="root"><kbd class="command">install -v -m644 doc/*.pdf /usr/share/doc/ffmpeg-4.4 &amp;&amp;
install -v -m644 doc/*.ps  /usr/share/doc/ffmpeg-4.4</kbd></pre><p>
      If you used <span class="command"><strong>doxygen</strong></span> to manually create the API 
      documentation, install it by issuing the following commands
      as the <code class="systemitem">root</code> user:
    </p><pre class="root"><kbd class="command">install -v -m755 -d /usr/share/doc/ffmpeg-4.4/api                     &amp;&amp;
cp -vr doc/doxy/html/* /usr/share/doc/ffmpeg-4.4/api                  &amp;&amp;
find /usr/share/doc/ffmpeg-4.4/api -type f -exec chmod -c 0644 \{} \; &amp;&amp;
find /usr/share/doc/ffmpeg-4.4/api -type d -exec chmod -c 0755 \{} \;</kbd></pre><p>
      To properly test the installation you must have rsync (in full book)
              
      installed and follow the instructions for the <a class="ulink" href="http://www.ffmpeg.org/fate.html"> FFmpeg Automated Testing
      Environment</a> (FATE). First, about 1 GB of sample files used to
      run FATE are downloaded with the command:
    </p><pre class="userinput"><kbd class="command">make fate-rsync SAMPLES=fate-suite/</kbd></pre><p>
      The <code class="filename">fate-suite</code> directory is
      created and the files are downloaded there. That command actually runs an
      rsync command, to obtain the sample files.  You may want to compress and
      keep this directory for testing again, in another system, or when a new
      version of ffmpeg is launched. Then, you unpack the sample files in the
      source directory, and run, again, the <span class="command"><strong>make fate-rsync
      ...</strong></span> command above, to sync with the repository. Now, the
      download size and time are drastically reduced.  Estimated values in
      "Package Information" do not include the download SBU. Some samples may
      have been removed, in the new version, so, in order to be sure local and
      server fate samples are identical, when you use previously saved samples,
      run the following command:
    </p><pre class="userinput"><kbd class="command">rsync -vrltLW  --delete --timeout=60 --contimeout=60 \
      rsync://fate-suite.ffmpeg.org/fate-suite/ fate-suite/</kbd></pre><p>
      Next, FATE is executed, with the commands (you obtain a number of tests
      larger than 3700):
    </p><pre class="userinput"><kbd class="command">make fate THREADS=<em class="replaceable"><code>N</code></em> SAMPLES=fate-suite/ | tee ../fate.log &amp;&amp;
grep ^TEST ../fate.log | wc -l</kbd></pre><p>
      where <em class="replaceable"><code>N</code></em> is an integer,
      <em class="replaceable"><code>N</code></em> &#8804; number of cores in the system.
    </p></div><div class="commands" lang="en" xml:lang="en"><h2 class="sect2">Command Explanations</h2><p>
      <span class="command"><strong>sed -i ... configure</strong></span>: This command adds the
      <span class="application">ALSA</span> library to the
      <span class="application">Flite</span> <code class="envar">LDFLAGS</code> variable and
      enables the discovery of <span class="application">Flite</span>.
    </p><p>
      <span class="command"><strong>find ... ;</strong></span>: Fixes permissions of documentation files
      and directories.
    </p><p>
      <em class="parameter"><code>--enable-libfreetype</code></em>: Enables
      <span class="application">Freetype</span> support.
    </p><p>
      <em class="parameter"><code>--enable-gpl</code></em>: Enables the use of GPL code and
      permits support for postprocessing, swscale and many other features.
    </p><p>
      <em class="parameter"><code>--enable-version3</code></em>: Enables the use of (L)GPL
      version 3 code.
    </p><p>
      <em class="parameter"><code>--enable-nonfree</code></em>: Enables the use of nonfree code.
      Note that the resulting libraries and binaries will be unredistributable.
    </p><p>
      <em class="parameter"><code>--disable-static</code></em>: This switch prevents
      installation of static versions of the libraries.
    </p><p>
      <em class="parameter"><code>--enable-shared</code></em>: Enables building shared
      libraries, otherwise only static libraries are built and installed.
    </p><p>
      <em class="parameter"><code>--disable-debug</code></em>: Disables building debugging
      symbols into the programs and libraries.
    </p><p>
      <em class="parameter"><code>--enable-avresample</code></em>: Enables
      transcode (in full book)
               to be compiled.
    </p><p>
      <em class="parameter"><code>--enable-libass</code></em>: Enables ASS/SSA subtitle format
      rendering via <code class="filename">libass</code>.
    </p><p>
      <code class="option">--enable-libdrm</code>: Use this switch if 
      libdrm (in full book)
               is installed to build the <span class="quote">&#8220;<span class="quote">kmsgrab</span>&#8221;</span>
      input module which is useful for screen capturing or streaming.
    </p><p>
      <em class="parameter"><code>--enable-libfdk-aac</code></em>: Enables currently the
      highest-quality AAC audio encoding via <code class="filename">libfdk-aac</code>.
    </p><p>
      <em class="parameter"><code>--enable-libmp3lame</code></em>: Enables MP3 audio encoding
      via <code class="filename">libmp3lame</code>.
    </p><p>
      <em class="parameter"><code>--enable-libvorbis --enable-libtheora</code></em>: Enables
      Theora video encoding via <code class="filename">libvorbis</code> and <code class="filename">libtheora</code>.
    </p><p>
      <em class="parameter"><code>--enable-libvorbis --enable-libvpx</code></em>: Enables WebM
      encoding via <code class="filename">libvorbis</code> and
      <code class="filename">libvpx</code>.
    </p><p>
      <em class="parameter"><code>--enable-libx264</code></em>: Enables high-quality
      H.264/MPEG-4 AVC encoding via <code class="filename">libx264</code>.
    </p><p>
      <em class="parameter"><code>--enable-libx265</code></em>: Enables high-quality
      H.265/HEVC encoding via <code class="filename">libx265</code>.
    </p><p>
      <em class="parameter"><code>--enable-openssl</code></em>:
      Enables HTTPS protocol for network streams.
    </p><p>
      <code class="option">--enable-gnutls</code>: Use this option instead of
      <em class="parameter"><code>--enable-openssl</code></em>, if you want to use
      <span class="application">GnuTLS</span> instead of
      <span class="application">OpenSSL</span> for HTTPS protocol.
    </p><p>
      <code class="option">--disable-doc</code>: Disables building html documentation.
      This is only needed if doxygen (in full book)
               is installed and you 
      do not want to build the html documentation.
    </p><p>
      <code class="option">--enable-libpulse</code>: Enables support for
      <span class="application">Pulseaudio</span> for audio output.
    </p><p>
      <span class="command"><strong>gcc tools/qt-faststart.c -o tools/qt-faststart</strong></span>: This
      builds the <span class="command"><strong>qt-faststart</strong></span> program which can modify
      QuickTime formatted movies (<code class="filename">.mov</code>
      or <code class="filename">.mp4</code>) so that the header
      information is located at the beginning of the file instead of the end.
      This allows the movie file to begin playing before the entire file has
      been downloaded.
    </p><div class="admon note"><img alt="[Note]" src="images/note.png" /><h3>Note</h3><p>
        Support for most of the dependency packages requires using options
        passed to the <span class="command"><strong>configure</strong></span> script. View the output
        from <span class="command"><strong>./configure --help</strong></span> for complete information
        about enabling dependency packages.
      </p></div></div><div class="content" lang="en" xml:lang="en"><h2 class="sect2">Contents</h2><div class="segmentedlist"><div class="seglistitem"><div class="seg"><strong class="segtitle">Installed Programs: </strong><span class="segbody">
          ffmpeg, ffplay, ffprobe,  and qt-faststart
        </span></div><div class="seg"><strong class="segtitle">Installed Libraries: </strong><span class="segbody">
          libavcodec.so, libavdevice.so, libavfilter.so,
          libavformat.so, libavutil.so, libavresample.so, libpostproc.so,
          libswresample.so, and libswscale.so
        </span></div><div class="seg"><strong class="segtitle">Installed Directories: </strong><span class="segbody">
          /usr/include/libav{codec,device,filter,format,resample,util},
          /usr/include/libpostproc,
          /usr/include/libsw{resample,scale},
          /usr/share/doc/ffmpeg-4.4, and
          /usr/share/ffmpeg
        </span></div></div></div><div class="variablelist"><h3>Short Descriptions</h3><table border="0" class="variablelist"><colgroup><col align="left" valign="top" /><col /></colgroup><tbody><tr><td><p><a id="ffmpeg-prog"></a><span class="term"><span class="command"><strong>ffmpeg</strong></span></span></p></td><td><p>
            is a command-line tool to convert video files, network streams and
            input from a TV card to several video formats
          </p></td></tr><tr><td><p><a id="ffplay"></a><span class="term"><span class="command"><strong>ffplay</strong></span></span></p></td><td><p>
            is a very simple and portable media player using the
            <code class="filename">ffmpeg</code> libraries and the SDL library
          </p></td></tr><tr><td><p><a id="ffprobe"></a><span class="term"><span class="command"><strong>ffprobe</strong></span></span></p></td><td><p>
            gathers information from multimedia streams and prints it in a human
            and machine-readable fashion
          </p></td></tr><tr><td><p><a id="qt-faststart"></a><span class="term"><span class="command"><strong>qt-faststart</strong></span></span></p></td><td><p>
            moves the index file to the front of quicktime (mov/mp4) videos
          </p></td></tr><tr><td><p><a id="libavcodec"></a><span class="term"><code class="filename">libavcodec.so</code></span></p></td><td><p>
            is a library containing the <span class="application">FFmpeg</span> codecs
            (both encoding and decoding)
          </p></td></tr><tr><td><p><a id="libavdevice"></a><span class="term"><code class="filename">libavdevice.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> device handling library
          </p></td></tr><tr><td><p><a id="libavfilter"></a><span class="term"><code class="filename">libavfilter.so</code></span></p></td><td><p>
            is a library of filters that can alter video or audio between the
            decoder and the encoder (or output)
          </p></td></tr><tr><td><p><a id="libavformat"></a><span class="term"><code class="filename">libavformat.so</code></span></p></td><td><p>
            is a library containing the file formats handling (mux and demux
            code for several formats) used by <span class="command"><strong>ffplay</strong></span> as well
            as allowing the generation of  audio or video streams
          </p></td></tr><tr><td><p><a id="libavresample"></a><span class="term"><code class="filename">libavresample.so</code></span></p></td><td><p>
            is a library containing functions for resampling audio and video.
          </p></td></tr><tr><td><p><a id="libavutil"></a><span class="term"><code class="filename">libavutil.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> utility library
          </p></td></tr><tr><td><p><a id="libpostproc"></a><span class="term"><code class="filename">libpostproc.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> post processing library
          </p></td></tr><tr><td><p><a id="libswresample"></a><span class="term"><code class="filename">libswresample.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> audio rescaling library,
            it contains functions for converting audio sample formats
          </p></td></tr><tr><td><p><a id="libswscale"></a><span class="term"><code class="filename">libswscale.so</code></span></p></td><td><p>
            is the <span class="application">FFmpeg</span> image rescaling library
          </p></td></tr></tbody></table></div></div><p class="updated">Last updated 
      on
      </p></div><div class="navfooter"><ul><li class="prev"><a accesskey="p" href="sdl2.html" title="SDL2-2.0.16">Prev</a><p>SDL2-2.0.16</p></li><li class="next"><a accesskey="n" href="appendices/creat-comm.html" title="Creative Commons License">Next</a><p>Creative Commons License</p></li><li class="up"><a accesskey="u" href="ch01.html" title="Chapter 1. Installing packages in dependency build order">Up</a></li><li class="home"><a accesskey="h" href="index.html" title="Beyond Linux® From Scratch &#10;  &#10;  (System V Edition) - Version 11.0">Home</a></li></ul></div></body></html>